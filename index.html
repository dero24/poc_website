<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Morphic Web ‚Äì Next-Gen Interactive AI POC</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">
<style>
body {
  font-family: 'Inter', Segoe UI, Arial, sans-serif;
  background:radial-gradient(150% 150% at 50% 0%,#7f9cf5 0%,#6772e5 100%);
  min-height:100vh; margin:0;padding:0;
  color:#222;
}
.container {
  max-width:700px; margin:48px auto 0; background:#fff; border-radius:20px;
  box-shadow:0 8px 38px rgba(84,90,139,0.13);
  padding:42px 36px 34px 36px;
}
.header {text-align:center; margin-bottom:28px;}
.logo {font-size:2.3em; color:#5055d5;font-weight:900;}
.slogan {margin:8px auto 0; font-size:1.18em; opacity:.84; color:#51515c; max-width:430px;}
.interaction-zone {margin-top:7px;}
.stats {display:flex; gap:17px;}
.stat-card {
  flex:1;background:linear-gradient(101deg,#5055d5 0%,#7f9cf5 80%);
  color:white; border-radius:10px; text-align:center; padding:10px 0 7px 0;font-weight:600;font-size:1.05em;
  box-shadow:0 2px 11px rgba(87,120,238,.15);
}
.stat-card h3 {margin:0;font-size:1.34em;}
.stat-card p {margin:2px 0 0; opacity:.7;}
.user-input-area {margin-bottom:14px;display:flex;gap:10px;}
.user-input-area textarea {
  width:100%;padding:13px 12px;border-radius:11px;min-height:60px;font-size:1.07em;
  border:2px solid #e0e3ee;font-family:'Inter',sans-serif;transition:border .18s;
}
.user-input-area textarea:focus {border-color:#6772e5;}
.generate-btn {
  background:linear-gradient(101deg,#6772e5 0%,#7f9cf5 90%);
  color:#fff; border:none;padding:13px 18px;border-radius:10px;font-size:1.09em;font-weight:700;cursor:pointer;
  box-shadow:0 2px 10px rgba(87,119,238,.12);margin-bottom:2px;
}
.generate-btn:hover {background:linear-gradient(101deg,#6a78e0 0%,#8598f8 90%);}
.generated-content {
  margin-top:13px;padding:20px 17px;background:#f7f8fc;border-radius:10px;min-height:115px;border:1.5px solid #ecebfd;
  transition:background .22s; box-shadow:0 2px 14px rgba(178,193,240,0.05);
}
.loading {text-align:center;padding:20px;color:#7f9cf5;font-size:1.10em;animation:pulse .72s cubic-bezier(.4,0,.2,1) infinite alternate;}
@keyframes pulse {to{color:#5055d5;}}
.history-log {margin-top:12px;padding:9px;background:#f7f8fc;border-radius:9px;max-height:120px;overflow-y:auto;border:1px solid #ecebfd;font-size:0.99em;}
.history-item {padding:6px;margin-bottom:4px;background:white;border-radius:5px;font-size:1em;border:1px solid #f1f3fa;}
.branding {text-align:center;font-size:0.93em;color:#abb3ca;margin-top:21px;}
@media(max-width:820px){.container{max-width:98vw;padding:3vw 1vw;}.stats{flex-direction:column;gap:7px;}}
</style>
</head>
<body>
<div class="container">
  <div class="header">
    <div class="logo">Morphic Web</div>
    <div class="slogan"><b>Next-gen interactive AI web platform.</b><br>
      Built on OpenRouter‚Äôs free LLMs; generates and runs real web apps, dynamically and safely.
    </div>
  </div>
  <div class="interaction-zone" id="interactionZone">
    <div class="stats">
      <div class="stat-card"><h3 id="interactionCount">0</h3><p>Interactions</p></div>
      <div class="stat-card"><h3 id="elementsCreated">0</h3><p>Elements Created</p></div>
      <div class="stat-card"><h3 id="adaptations">0</h3><p>Adaptations</p></div>
    </div>
    <div class="user-input-area">
      <textarea id="userIntent" placeholder="Describe any cool interactive tool‚Äîe.g. 'todo app', 'financial dashboard', 'game', or 'AI assistant'"></textarea>
      <button type="button" onclick="generateInterface()" class="generate-btn">üöÄ Generate</button>
    </div>
    <div class="generated-content" id="generatedContent">
      <p style="color:#aaa;text-align:center;">Your AI-powered tool will appear here. Buttons and widgets will <b>just work</b>!</p>
    </div>
    <div class="history-log" id="historyLog"><strong>History:</strong></div>
  </div>
  <div class="branding">Morphic Web &copy; 2025 | Powered by OpenRouter AI</div>
</div>
<script>
const OR_API = "https://openrouter.ai/api/v1/chat/completions";
const OR_MODEL = "deepseek-coder:free";
let interactionCount=0, elementsCreated=0, adaptations=0, conversationHistory=[];
function updateStats() {
  document.getElementById('interactionCount').textContent=interactionCount;
  document.getElementById('elementsCreated').textContent=elementsCreated;
  document.getElementById('adaptations').textContent=adaptations;
}
function logHistory(msg) {
  const log=document.getElementById('historyLog'),item=document.createElement('div');
  item.className='history-item';
  item.textContent=`${new Date().toLocaleTimeString()} - ${msg}`;
  log.appendChild(item); log.scrollTop=log.scrollHeight;
}
async function generateInterface() {
  const intent=document.getElementById('userIntent').value.trim();
  const content=document.getElementById('generatedContent');
  if(!intent){alert('Describe what to build.');return;}
  content.innerHTML='<div class="loading">‚ö°Ô∏è Creating your app...</div>';
  interactionCount++; updateStats();
  const context=conversationHistory.length>0?`Last: ${conversationHistory.slice(-2).join(', ')}`:'';
  const prompt=`You are MorphicWeb, a world-class JavaScript app generator. Take this user request: "${intent}". Create:
1. HTML and CSS (must be immediately usable, modern, beautiful).
2. JavaScript code for all working interactivity (in one <script> block at the end).
3. All inputs/widgets/buttons must work, running the correct logic.
4. For every <button> or clickable element, set proper event handlers using JavaScript (not inline)!
Your output structure must be:
<div id="container"> ... </div>
<style>...</style>
<script>...</script>
No explanations, markdown, or code fences‚Äîoutput pure code. If an error, display visually using <div class="error-message">.
${context}`;
  try {
    const html = await callOpenRouter(prompt);
    parseAndInjectHTML(html,content);
    conversationHistory.push(intent);
    elementsCreated+=countElements(html); adaptations++;
    updateStats(); logHistory(`‚ú® App: "${intent.substring(0,44)}..."`);
    document.getElementById('userIntent').value='';
  } catch(e) {
    content.innerHTML=`<div class='error-message'>Error: ${e.message}</div>`;
    logHistory(`‚ö†Ô∏è ${e.message}`);
  }
}

async function callOpenRouter(prompt) {
  const raw=await fetch(OR_API,{
    method:"POST",
    headers: {
      "Content-Type":"application/json",
      "HTTP-Referer":"https://github.com/",
      "X-Title":"MorphicWeb" },
    body: JSON.stringify({
      model: OR_MODEL, messages: [{role:"user", content:prompt}],
      max_tokens: 1400, temperature: 0.7
    })
  });
  if(!raw.ok) throw new Error("Failed contacting AI service: "+raw.statusText);
  const data=await raw.json();
  let text=(data.choices&&data.choices[0]?.message?.content)?data.choices[0].message.content.trim():"";
  text=text.replace(/``````/g,'').trim();
  if(!text.toLowerCase().includes("<div")) throw new Error("No usable app returned‚Äîtry a simpler prompt.");
  return text;
}

function parseAndInjectHTML(raw, container) {
  // Extract core blocks and inject/run as needed
  let html=raw, style="", script="";
  // ??? Extract <style> and <script> blocks
  style = html.match(/<style[^>]*>([\s\S]*?)<\/style>/i)?.[1] || "";
  script = html.match(/<script[^>]*>([\s\S]*?)<\/script>/i)?.[1] || "";
  html = html.replace(/<style[^>]*>[\s\S]*?<\/style>/gi, "")
             .replace(/<script[^>]*>[\s\S]*?<\/script>/gi, "");
  // Render HTML
  container.innerHTML = html;
  if(style) {
    let styleEl=document.createElement('style');
    styleEl.textContent=style;
    container.appendChild(styleEl);
  }
  if(script) {
    let scriptEl=document.createElement('script');
    scriptEl.textContent=script;
    container.appendChild(scriptEl);
  }
}

function countElements(html) {
  const div=document.createElement('div'); div.innerHTML=html;
  return div.querySelectorAll('*').length;
}
document.addEventListener("DOMContentLoaded", ()=>{
  document.getElementById('userIntent')?.addEventListener('keydown',(e)=>{
    if(e.key==='Enter'&&e.ctrlKey)generateInterface();
  });
});
</script>
</body>
</html>
